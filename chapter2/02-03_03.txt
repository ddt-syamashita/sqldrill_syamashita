
作成者：山下
作成日：2021/2/10

chapter2

2-3
問3
社員テーブル（employee）から
それぞれの社員氏名と上司氏名を、社員コードについて昇順に取り出してみましょう。
なお、取り出す列は別名として「社員氏名」「上司氏名」とし、
上司がいない社員についても情報は取り出すことにします。


//取り出す列を指定するため、SELECT文を定義
SELECT
	//社員氏名を出力させるため、氏列と名列をCOUNT関数を使用し結合させる。列名を指定するためASを使用
	CONCAT(em.l_name, em.f_name) AS 社員氏名,
	//上司氏名を出力させるため、氏列と名列をCOUNT関数を使用し結合させる。列名を指定するためASを使用
	CONCAT(ep.l_name, ep.f_name) AS 上司氏名
//どのテーブルから取得するのか
FROM
	//社員テーブルから取得する。同一テーブルを結合するので、差別化させるためにASを使用する
	employee AS em
//社員氏名側のデータを全て取り出す。emテーブルを指定するためLEFT JOINを定義
LEFT JOIN
	//社員テーブルから取得する。同一テーブルを結合するので、差別化させるためにASを使用する
	employee AS ep
//結合するキーを指定するためONを定義
ON
	//上司コードと社員コードをキーとして結合させる
	em.b_id=ep.s_id
//出力結果を並べ替えるため、ORDER BYを定義
ORDER BY
	社員コードの昇順に並べ替えるため、ASCを定義
	em.s_id ASC
;



実行結果
mysql> SELECT
    -> CONCAT(em.l_name, em.f_name) AS 社員氏名,
    -> CONCAT(ep.l_name, ep.f_name) AS 上司氏名
    -> FROM
    -> employee AS em
    -> LEFT JOIN
    -> employee AS ep
    -> ON
    -> em.b_id=ep.s_id
    -> ORDER BY
    -> em.s_id ASC
    -> ;
+------------+------------+
| 社員氏名   | 上司氏名   |
+------------+------------+
| 相沢聡     | NULL       |
| 大門一郎   | 相沢聡     |
| 藤井雄太   | 妹尾春樹   |
| 藤岡幸太郎 | 藤井雄太   |
| 速水和幸   | NULL       |
| 葉山俊輔   | 藤岡幸太郎 |
| 川口裕子   | NULL       |
| 加藤昭雄   | NULL       |
| 神田佐知子 | 神田佐知子 |
| 木村一郎   | 田中真由子 |
| 中澤康代   | 戸川よしみ |
| 西雄一     | NULL       |
| 新渡戸康治 | NULL       |
| 野上利江   | 戸川よしみ |
| 佐藤智子   | NULL       |
| 妹尾春樹   | 寺岡陽一   |
| 清水春子   | 清水春子   |
| 田中真由子 | 山田奈美   |
| 田辺正一   | 葉山俊輔   |
| 寺岡陽一   | 速水和幸   |
| 近田晃子   | 相沢聡     |
| 遠山真一   | 上田一也   |
| 戸川よしみ | 津村知美   |
| 津村知美   | 近田晃子   |
| 上田一也   | NULL       |
| 山田奈美   | 佐藤智子   |
+------------+------------+
26 rows in set (0.00 sec)
